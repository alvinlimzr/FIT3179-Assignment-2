<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FIT3179 Assignment 2 — Health & Wealth</title>
  <meta name="description" content="Three Vega-Lite visuals exploring how income relates to life expectancy." />
  <style>
    :root{
      --maxw: 1280px;
      --fg: #111;
      --muted:#5b6572;
      --border:#e6e6e6;
      --bg:#fff;
      --callout:#f6f8fb;
      --ink: #0b3d91;
    }
    html,body{background:var(--bg); color:var(--fg);}
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      line-height:1.6; margin:0 auto; max-width:var(--maxw); padding:1rem 1.25rem 4rem;
    }
    header{ position: sticky; top:0; background:rgba(255,255,255,.9); backdrop-filter:saturate(160%) blur(6px); border-bottom:1px solid var(--border); z-index:5;}
    header .bar{ display:flex; align-items:center; gap:1rem; padding:.65rem 0; }
    header strong{ font-size:1rem; letter-spacing:.2px; }
    nav a{ color:#1a73e8; text-decoration:none; margin-right:1rem; font-size:.95rem;}
    nav a:hover{ text-decoration:underline; }
    h1{ font-size:1.9rem; margin:.85rem 0 .4rem; }
    h2{ font-size:1.35rem; margin:2rem 0 .6rem; }
    p.lede{ color:var(--muted); margin:.25rem 0 1rem; max-width:none !important; }
    section{ margin: 1.25rem 0 2.25rem; }
    figure{ margin:0; }
    .vis { width:100%; }
    .vis--wide { max-width: 1200px; margin: 0 auto; }
    figcaption{ color:var(--muted); font-size:.93rem; margin:.5rem 0 0; }
    .callout{
      background:var(--callout); border:1px solid var(--border);
      padding:.85rem .95rem; border-radius:.8rem; margin:.75rem 0 1rem;
    }
    .callout strong{ color:var(--ink); }
    .source-note{ color:var(--muted); font-size:.88rem; border-top:1px dashed var(--border); padding-top:.75rem; margin-top:.6rem;}
    .kbd{ font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size:.9em; background:#f1f1f1; padding:.05rem .35rem; border-radius:.35rem; }

    /* full-width, readable project summary */
    .project-summary{
      font-size:1.05rem;
      line-height:1.75;
      color:#273242;
      background:#fafbff;
      border:1px solid #e8ecf6;
      border-radius:.9rem;
      padding:1rem 1.1rem;
      max-width: none; /* full line */
    }
  </style>
</head>
<body>
  <header role="banner" aria-label="Sticky navigation">
    <div class="bar">
      <strong>FIT3179 Assignment 2</strong>
      <nav class="toc" aria-label="Sections">
        <a href="#map">1. Global snapshot</a>
        <a href="#scatter">2. Relationship</a>
        <a href="#bars">3. Focus comparison</a>
      </nav>
    </div>
  </header>

  <main id="top">
    <h1>Health & Wealth: a short data story</h1>
    <p class="lede">
      This page walks you through three views of income and longevity. Start with a world snapshot, then explore how the two relate, and finally compare a few countries side by side.
    </p>

    <!-- 1) Global map -->
    <section id="map" aria-labelledby="h-map">
      <h2 id="h-map">1) Global snapshot — World GDP per capita (2024)</h2>
      <div class="callout">
        <strong>What you’re seeing:</strong> incomes are highest across North America, Western Europe, Australia/New Zealand and parts of East Asia. Many countries in Sub-Saharan Africa and South Asia have much lower incomes. Grey areas indicate places where 2024 values are missing.
      </div>
      <figure>
        <div id="vis_map" class="vis vis--wide" role="img" aria-label="Choropleth map of GDP per capita in 2024"></div>
        <figcaption>Equal-Earth projection; 30° graticule. Missing data in grey.</figcaption>
      </figure>
    </section>

    <!-- 2) Relationship -->
    <section id="scatter" aria-labelledby="h-scatter">
      <h2 id="h-scatter">2) Relationship — Life expectancy vs GDP per capita</h2>
      <figure>
        <div id="vis_scatter" class="vis" role="img" aria-live="polite" aria-label="Scatter of life expectancy versus GDP per capita with a year slider"></div>
        <figcaption>Move the <span class="kbd">Year</span> slider below the chart; the GDP axis is log-scaled.</figcaption>
        <p class="source-note">Note: 2024 data not available.</p>
      </figure>
      <div class="callout" aria-label="Interpretation note">
        <strong>The curve flattens.</strong> From very low to middle incomes, life expectancy jumps quickly—think basic sanitation, vaccines and safer births. After roughly US$20–30k per person, extra income buys smaller health gains. Countries at similar income levels can still differ a lot: Singapore and Japan squeeze out more years than peers, while the United States sits below countries with comparable GDP.
      </div>
    </section>

    <!-- 3) Focus comparison bars -->
    <section id="bars" aria-labelledby="h-bars">
      <h2 id="h-bars">3) Focus countries — life expectancy (selected year)</h2>
      <figure>
        <div id="vis_bars" class="vis" role="img" aria-label="Bar chart comparing life expectancy for focus countries in the selected year"></div>
        <figcaption>Sorted high to low; hover for GDP per capita context. Uses the same year slider as the scatter.</figcaption>
        <p class="source-note">Note: 2024 data not available.</p>
      </figure>
    </section>

    <section aria-labelledby="h-take">
      <h2 id="h-take">Project summary</h2>
      <p class="project-summary">
        Globally, richer countries tend to live longer, but the payoff slows as incomes rise. Moving out of poverty delivers big health improvements; beyond middle-income levels, progress depends more on effective health systems and policy than on income alone. Looking at Singapore, the United States, China, India, Australia and Indonesia side by side shows how similar incomes can lead to different outcomes—and how some nations convert growth into extra years of life faster than others.
      </p>
      <p class="source-note">
        Sources: World Bank (GDP per capita, current US$); Our World in Data / UN (life expectancy).
        Notes: GDP snaps to the nearest available year; countries with missing values are excluded.
      </p>
    </section>
  </main>

  <!-- Vega libraries -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <script>
    // Map (keep the working spec)
    vegaEmbed("#vis_map", "world_gdp_map.json?v=16", { actions: false }).catch(console.error);

    // Scatter
    vegaEmbed("#vis_scatter", "life_vs_gdp.json?v=6", { actions: false })
      .then(() => {
        // Hide duplicate sliders and sync values. Cap all sliders to 2023.
        const syncSliders = () => {
          const sliders = document.querySelectorAll('input[name="Year"]');
          if (sliders.length >= 2) {
            const master = sliders[0];       // visible (scatter)
            master.max = '2023';

            for (let i = 1; i < sliders.length; i++) {
              const wrap = sliders[i].closest('.vega-bindings');
              if (wrap) wrap.style.display = 'none'; // hides label + value + input (prevents "Year2022")
              sliders[i].max = '2023';
            }

            master.addEventListener('input', () => {
              for (let i = 1; i < sliders.length; i++) {
                sliders[i].value = master.value;
                sliders[i].dispatchEvent(new Event('input', { bubbles: true }));
              }
            });
          }
        };
        setTimeout(syncSliders, 200);
        window.__syncYear = syncSliders;
      })
      .catch(console.error);

    // Bars
    vegaEmbed("#vis_bars", "focus_bars.json?v=2", { actions: false })
      .then(() => { if (window.__syncYear) window.__syncYear(); })
      .catch(console.error);
  </script>
</body>
</html>
